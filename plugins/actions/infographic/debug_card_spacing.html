<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¡ç‰‡é—´è·è°ƒè¯•å·¥å…·</title>
    <script src="https://registry.npmmirror.com/@antv/infographic/0.2.1/files/dist/infographic.min.js"></script>
    <style>
        * {
            box-sizing: border-box;
        }

        body {
            margin: 0;
            padding: 20px;
            background: #f0f0f0;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
        }

        .debug-container {
            display: flex;
            gap: 20px;
            max-width: 1400px;
            margin: 0 auto;
        }

        .controls {
            width: 320px;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            height: fit-content;
            position: sticky;
            top: 20px;
        }

        .controls h2 {
            margin-top: 0;
            font-size: 16px;
            color: #333;
        }

        .controls label {
            display: block;
            margin: 16px 0 6px;
            font-size: 14px;
            color: #666;
            font-weight: 500;
        }

        .controls input {
            width: 100%;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
        }

        .controls button {
            width: 100%;
            padding: 10px;
            margin-top: 16px;
            background: #6366f1;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
        }

        .controls button:hover {
            background: #4f46e5;
        }

        .controls .info {
            margin-top: 20px;
            padding: 12px;
            background: #f1f5f9;
            border-radius: 6px;
            font-size: 13px;
            color: #475569;
            line-height: 1.6;
        }

        .preview {
            flex: 1;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }

        #infographic-container {
            min-height: 500px;
            padding: 24px;
        }

        /* åŸºç¡€æ ·å¼ */
        #infographic-container svg text {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", sans-serif !important;
        }

        #infographic-container svg foreignObject {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", sans-serif !important;
            line-height: 1.4 !important;
        }

        /* ä¸»æ ‡é¢˜æ ·å¼ */
        #infographic-container svg foreignObject[data-element-type="title"]>* {
            font-size: 1.2em !important;
            font-weight: bold !important;
            line-height: 1.4 !important;
            white-space: nowrap !important;
            overflow: hidden !important;
            text-overflow: ellipsis !important;
        }

        /* é¡µé¢å‰¯æ ‡é¢˜æ ·å¼ */
        #infographic-container svg foreignObject[data-element-type="desc"]>* {
            font-size: 0.6em !important;
            line-height: 1.4 !important;
            white-space: nowrap !important;
            overflow: hidden !important;
            text-overflow: ellipsis !important;
        }

        /* å¡ç‰‡æ ‡é¢˜å’Œæè¿°æ ·å¼ï¼ˆè¿™é‡Œæ˜¯é‡ç‚¹è°ƒè¯•åŒºåŸŸï¼‰ */
        #infographic-container svg foreignObject[data-element-type="item-label"]>* {
            font-size: 0.6em !important;
            line-height: 1.4 !important;
            white-space: nowrap !important;
            overflow: hidden !important;
            text-overflow: ellipsis !important;
        }

        #infographic-container svg foreignObject[data-element-type="item-desc"]>* {
            line-height: 1.4 !important;
            white-space: normal !important;
        }
    </style>
</head>

<body>
    <div class="debug-container">
        <div class="controls">
            <h2>ğŸ”§ å¡ç‰‡é—´è·è°ƒè¯•é¢æ¿</h2>

            <label>å¡ç‰‡æ ‡é¢˜ä¸æè¿°é—´è· (margin-top)</label>
            <input type="text" id="label-desc-gap" value="8px" placeholder="ä¾‹å¦‚: 8px, 12px, 1em">

            <label>å¡ç‰‡æ ‡é¢˜å­—ä½“å¤§å°</label>
            <input type="text" id="label-size" value="0.6em" placeholder="ä¾‹å¦‚: 0.6em, 12px">

            <label>å¡ç‰‡æè¿°å­—ä½“å¤§å°</label>
            <input type="text" id="desc-size" value="0.5em" placeholder="ä¾‹å¦‚: 0.5em, 10px">

            <label>å¡ç‰‡å†…è¾¹è· (padding)</label>
            <input type="text" id="card-padding" value="8px" placeholder="ä¾‹å¦‚: 8px, 12px">

            <button onclick="applyStyles()">åº”ç”¨æ ·å¼</button>
            <button onclick="reRender()" style="background: #10b981; margin-top: 8px;">é‡æ–°æ¸²æŸ“</button>

            <div class="info">
                <strong>è¯´æ˜ï¼š</strong><br>
                â€¢ æ ‡é¢˜ä¸æè¿°é—´è·ï¼šæ§åˆ¶æ ‡é¢˜å’Œå†…å®¹ä¹‹é—´çš„å‚ç›´é—´è·<br>
                â€¢ å­—ä½“å¤§å°ï¼šåˆ†åˆ«æ§åˆ¶æ ‡é¢˜å’Œæè¿°çš„æ–‡å­—å¤§å°<br>
                â€¢ å†…è¾¹è·ï¼šæ§åˆ¶æ•´ä¸ªå¡ç‰‡å†…çš„ç•™ç™½
            </div>
        </div>

        <div class="preview">
            <div id="infographic-container"></div>
        </div>
    </div>

    <script>
        function applyStyles() {
            console.log('[Debug] åº”ç”¨å¡ç‰‡æ ·å¼...');

            const labelDescGap = document.getElementById('label-desc-gap').value;
            const labelSize = document.getElementById('label-size').value;
            const descSize = document.getElementById('desc-size').value;
            const cardPadding = document.getElementById('card-padding').value;

            const container = document.getElementById('infographic-container');

            // å¡ç‰‡æ ‡é¢˜
            const itemLabels = container.querySelectorAll('svg foreignObject[data-element-type="item-label"]');
            itemLabels.forEach(fo => {
                const firstChild = fo.querySelector(':scope > *');
                if (firstChild) {
                    firstChild.style.setProperty('font-size', labelSize, 'important');
                    firstChild.style.setProperty('margin-bottom', labelDescGap, 'important');
                }
            });

            // å¡ç‰‡æè¿°
            const itemDescs = container.querySelectorAll('svg foreignObject[data-element-type="item-desc"]');
            itemDescs.forEach(fo => {
                const firstChild = fo.querySelector(':scope > *');
                if (firstChild) {
                    firstChild.style.setProperty('font-size', descSize, 'important');
                }
            });

            // å°è¯•è°ƒæ•´å¡ç‰‡æ•´ä½“å†…è¾¹è·ï¼ˆé€šè¿‡è°ƒæ•´ g å…ƒç´ çš„ paddingï¼‰
            const cardGroups = container.querySelectorAll('svg g[data-element-type="items-group"] > g');
            cardGroups.forEach(group => {
                // è¿™é‡Œå¯èƒ½éœ€è¦é€šè¿‡è°ƒæ•´å†…éƒ¨ g çš„ transform æ¥å®ç°
                // AntV çš„å¸ƒå±€æ¯”è¾ƒå¤æ‚ï¼Œpadding å¯èƒ½éœ€è¦é€šè¿‡å…¶ä»–æ–¹å¼å®ç°
            });

            console.log('[Debug] å¡ç‰‡æ ·å¼å·²åº”ç”¨:', {
                labelDescGap,
                labelSize,
                descSize,
                cardPadding
            });
        }

        function reRender() {
            const container = document.getElementById('infographic-container');
            container.innerHTML = '';

            const syntaxContent = `infographic list-grid-compact-card
data
  title ğŸš€ åŠŸèƒ½äº®ç‚¹è¯´æ˜
  desc ç³»ç»Ÿæ ¸å¿ƒé€»è¾‘ä¸äº¤äº’è§†è§‰ç‰¹æ€§
  items
    - label æ ¸å¿ƒæµç¨‹æ¼”ç¤º
      icon mdi/database-cog
      desc åŒ…å«4ä¸ªæ•°æ®æºã€4æ¡åˆ†æµç®¡é“ï¼ˆè¿è´¹/å•†å“/é€€è´§ï¼‰ä»¥åŠUNION ALLä¸GROUP BYèšåˆèŠ‚ç‚¹
    - label çµåŠ¨åŠ¨ç”»æ•ˆæœ
      icon mdi/motion-play
      desc æ”¯æŒ5ä¸ªè®¢å•å¤šè‰²å¹¶è¡Œæµè½¬ã€ç®¡é“éœ“è™¹é—ªçƒå…‰æ™•ã€èŠ‚ç‚¹æ—‹è½¬åŠä»ªè¡¨ç›˜æ•°å€¼è·³åŠ¨åé¦ˆ
    - label æç®€äº¤äº’æ§åˆ¶
      icon mdi/cursor-default-click
      desc å†…ç½®å¼€å§‹/æš‚åœ/é‡ç½®é€»è¾‘ï¼Œæ”¯æŒ1xè‡³4xå€é€Ÿè°ƒæ•´ï¼Œå¹¶é›†æˆå®æ—¶ä»ªè¡¨æ¿ä¸æ—¥å¿—ç³»ç»Ÿ
    - label èµ›åšæœ‹å…‹é£æ ¼
      icon mdi/palette
      desc é‡‡ç”¨æ·±è“ç´«è‰²è°ƒã€éœ“è™¹ç»¿æ–‡å­—å½±ã€ç½‘æ ¼èƒŒæ™¯ä»¥åŠæ¸å˜å‘å…‰è¾¹æ¡†ï¼Œæ‰“é€ æå®¢è§†è§‰ä½“éªŒ`;

            if (typeof AntVInfographic === 'undefined') {
                container.innerHTML = '<div style="color: red; padding: 20px;">âš ï¸ AntV Infographic åº“æœªåŠ è½½</div>';
                return;
            }

            try {
                const { Infographic } = AntVInfographic;
                const instance = new Infographic({
                    container: '#infographic-container',
                    padding: 24,
                });
                instance.render(syntaxContent);
                console.log('[Debug] æ¸²æŸ“å®Œæˆ');

                // æ¸²æŸ“å®Œæˆåè‡ªåŠ¨åº”ç”¨æ ·å¼
                setTimeout(() => {
                    applyStyles();
                }, 300);
            } catch (error) {
                container.innerHTML = '<div style="color: red; padding: 20px;">âš ï¸ æ¸²æŸ“é”™è¯¯: ' + error.message + '</div>';
                console.error(error);
            }
        }

        // é¡µé¢åŠ è½½åè‡ªåŠ¨æ¸²æŸ“
        window.onload = function () {
            setTimeout(reRender, 500);
        };
    </script>
</body>

</html>